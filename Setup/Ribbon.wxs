<?xml version="1.0" encoding="UTF-8"?>
<!--
    # This comment is generated by WixEdit, the specific commandline
    # arguments for the WiX Toolset are stored here.

    candleArgs: "<projectname>.wxs" -out "obj\Release\<projectname>.wixobj"
    lightArgs: "obj\Release\<projectname>.wixobj" -out "msi\<projectname>.msi" -ext WixUtilExtension -ext WixUIExtension -ext WixNetFxExtension
-->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:netfx="http://schemas.microsoft.com/wix/NetFxExtension"
     xmlns:WixUI="http://schemas.microsoft.com/wix/UIExtension">
  <Product Id="{290EB9B3-047E-46BA-B5F6-56832F7F4169}" Name="Ribbon" Language="1033" Version="2.15.0.0" Manufacturer="RibbonLib" UpgradeCode="FA403F70-F169-497E-8DC2-CCA0609A1E30">
    <Package InstallerVersion="301" Compressed="yes" InstallScope="perMachine" Platform="x86" Description="Windows Ribbon Framework Library for .NET" />

    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
    <Media Id="1" Cabinet="Data.cab" EmbedCab="yes" />

    <Feature Id="ProductFeature" Title="Windows Ribbon for .NET Setup" Level="1">
      <ComponentGroupRef Id="GACComponents" />
      <ComponentGroupRef Id="ProductComponents" />
    </Feature>
    <UI />
    <PropertyRef Id="NETFRAMEWORK35" />
    <Condition Message="This library requires .NET Framework 3.5.">Installed OR NETFRAMEWORK35</Condition>
    <UIRef Id="WixUI_Minimal" />
    <UIRef Id="WixUI_ErrorProgressText" />
    <Icon Id="MainIcon.ico" SourceFile=".\Ribbon.ico" />
    <Property Id="ARPPRODUCTICON" Value="MainIcon.ico" />
    <Property Id="ARPHELPLINK" Value="https://github.com/harborsiem/WindowsRibbon/wiki" />
    <Property Id="ARPCOMMENTS" Value="Windows Ribbon Framework Library for .NET" />
    <Property Id="ARPURLUPDATEINFO" Value="https://github.com/harborsiem/WindowsRibbon/releases" />
    <Property Id="ARPNOREPAIR" Value="yes" />
    <WixVariable Id="WixUILicenseRtf" Value="Ms-PL_License.rtf" />
  </Product>

  <Fragment>
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="Di.INSTALLFOLDER" Name="RibbonLib">
			<Directory Id="Di.GAC_CLONE" Name="GacClone">
			</Directory>
        </Directory>
      </Directory>
    </Directory>
  </Fragment>

  <Fragment>
    <ComponentGroup Id="GACComponents" Directory="TARGETDIR">
      <Component Id="C.RegistryEntries" Guid="DC659167-AE0C-4BAD-B67A-00785AB4FE54">
        <!--
          .NET2.0, 3.5 GAC Assembly
          -->
        <RegistryKey Root="HKLM" Key="Software\Microsoft\.NETFramework\AssemblyFolders\[ProductName]" ForceCreateOnInstall="yes" ForceDeleteOnUninstall="yes" Id="R.AssemblyRef">
          <RegistryValue Type="string" Value="[ProgramFilesFolder]RibbonLib\GacClone" />
        </RegistryKey>
        <!--
          .NET4.x GAC Assembly
        <RegistryKey Root="HKLM" Key="Software\Microsoft\.NETFramework\v4.0.30319\AssemblyFoldersEx\[ProductName]" ForceCreateOnInstall="yes" ForceDeleteOnUninstall="yes" Id="R.AssemblyRef4">
          <RegistryValue Type="string" Value="[ProgramFilesFolder]RibbonLib\" KeyPath="yes" />
        </RegistryKey>
          -->
      </Component>
      <Component Id="C.GacRibbonDll" Guid="2317CAD9-D132-4996-B01A-AD6A234528B0">
        <File Id="Fi.GacRibbonDll" Name="Ribbon.dll" Source="..\Ribbon\bin\Release\Ribbon.dll" KeyPath="yes" Assembly=".net" />
      </Component>
    </ComponentGroup>
  </Fragment>

  <Fragment>
    <ComponentGroup Id="ProductComponents" Directory="Di.GAC_CLONE">
      <Component Id="C.RibbonBin" Guid="D0AB8E49-9794-429B-888B-C591AF0B1E84">
        <File Id="Fi.RibbonDllClone" Name="Ribbon.dll" Source="..\Ribbon\bin\Release\Ribbon.dll" KeyPath="yes" />
        <File Id="Fi.RibbonPdb" Name="Ribbon.pdb" Source="..\Ribbon\bin\Release\Ribbon.pdb" />
        <File Id="Fi.RibbonXml" Name="Ribbon.xml" Source="..\Ribbon\bin\Release\Ribbon.xml" />
      </Component>
    </ComponentGroup>
  </Fragment>
</Wix>
