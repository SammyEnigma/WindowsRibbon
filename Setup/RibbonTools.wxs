<?xml version="1.0" encoding="UTF-8"?>
<!--
    # This comment is generated by WixEdit, the specific commandline
    # arguments for the WiX Toolset are stored here.

    candleArgs: "<projectname>.wxs" -out "obj\Release\<projectname>.wixobj"
    lightArgs: "obj\Release\<projectname>.wixobj" -out "msi\<projectname>.msi" -ext WixUtilExtension -ext WixUIExtension -ext WixNetFxExtension
-->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:netfx="http://schemas.microsoft.com/wix/NetFxExtension"
     xmlns:WixUI="http://schemas.microsoft.com/wix/UIExtension">
  <Product Id="{AFA3104D-029B-464E-8C53-D10F1FE57999}" Name="RibbonTools" Language="1033" Version="1.3.6.0" Manufacturer="RibbonLib" UpgradeCode="8D7B31EC-7EA5-4A82-A4AB-31E2B98A3D21">
    <Package InstallerVersion="301" Compressed="yes" InstallScope="perMachine" Platform="x86" Description="Design, Build and Preview the Ribbon" />

    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
    <Media Id="1" Cabinet="Data.cab" EmbedCab="yes" />

    <Feature Id="ProductFeature" Title="RibbonTools Setup" Level="1">
      <ComponentGroupRef Id="ProductComponents" />
      <ComponentGroupRef Id="ProductComponents2" />
    </Feature>
    <UI />
    <PropertyRef Id="WIX_IS_NETFRAMEWORK_462_OR_LATER_INSTALLED" />
    <Condition Message="This application requires .NET Framework 4.6.2">Installed OR WIX_IS_NETFRAMEWORK_462_OR_LATER_INSTALLED</Condition>
    <UIRef Id="WixUI_Minimal" />
    <UIRef Id="WixUI_ErrorProgressText" />
    <Icon Id="MainIcon.ico" SourceFile="Ribbon.ico" />
    <Property Id="ARPPRODUCTICON" Value="MainIcon.ico" />
    <Property Id="ARPHELPLINK" Value="https://github.com/harborsiem/WindowsRibbon/wiki" />
    <Property Id="ARPCOMMENTS" Value="Design, Build and Preview Windows Ribbon" />
    <Property Id="ARPURLUPDATEINFO" Value="https://github.com/harborsiem/WindowsRibbon/releases" />
    <Property Id="ARPNOREPAIR" Value="yes" />
    <WixVariable Id="WixUILicenseRtf" Value="MIT_License.rtf" />
  </Product>

  <Fragment>
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="Di.INSTALLFOLDER" Name="RibbonLib">
        </Directory>
      </Directory>
      <Directory Id="ProgramMenuFolder">
      </Directory>
    </Directory>
  </Fragment>


  <Fragment>
    <ComponentGroup Id="ProductComponents" Directory="Di.INSTALLFOLDER">
      <Component Id="C.RibbonBin4" Guid="D0AB8E49-9794-429B-888B-C591AF0B1E84">
        <Environment Id="PATH" Name="Path" Value="[Di.INSTALLFOLDER]" Permanent="no" Part="last" Action="set" System="yes" />
        <File Id="Fi.RibbonExe" Name="RibbonTools.exe" Source="..\RibbonTools\bin\Release\RibbonTools.exe" KeyPath="yes" />
        <File Id="Fi.RibbonExeConfig" Name="RibbonTools.exe.config" Source="..\RibbonTools\bin\Release\RibbonTools.exe.config" Checksum="yes" />
        <File Id="Fi.RibbonPdb" Name="RibbonTools.pdb" Source="..\RibbonTools\bin\Release\RibbonTools.pdb" />
      </Component>
    </ComponentGroup>
  </Fragment>

  <Fragment>
    <ComponentGroup Id="ProductComponents2" Directory="ProgramMenuFolder">
      <Component Id="C.AppMenu" Guid="31676EDB-CA37-42F6-B415-179E5D7EC393">
        <Shortcut Id="ApplicationStartMenuShortcut" Name="RibbonTools" Target="[!Fi.RibbonExe]" WorkingDirectory="Di.INSTALLFOLDER" Icon="MainIcon.ico" IconIndex="0" />
        <RegistryValue Root="HKCU" Key="Software\[Manufacturer]\[ProductName]" Value="" Type="string" KeyPath="yes" />
      </Component>
    </ComponentGroup>
  </Fragment>

</Wix>
